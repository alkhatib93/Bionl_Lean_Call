{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/<your-org-or-user>/Bionl_Lean_Call/main/nextflow_schema.json",
  "title": "Bionl_Lean_Call parameters",
  "description": "A germline variant-calling workflow focused on ACMG Secondary Findings (research use only), with standardized QC, annotation, and per-sample reports.",
  "type": "object",

  "properties": {
    "outdir": {
      "type": "string",
      "description": "Directory where analysis results will be saved.",
      "help_text": "Results are organized by step with subfolders for qc/, vcf/, and reports/.",
      "fa_icon": "fas fa-folder-open",
      "format": "directory-path"
    },

    "run_sarek": {
      "type": "boolean",
      "default": true,
      "description": "If true, run nf-core/sarek inside this workflow using a FASTQ samplesheet. If false, reuse existing VCF/BAMs (either via a Sarek output directory or a post-only samplesheet).",
      "fa_icon": "fas fa-toggle-on"
    },

    "samplesheet": {
      "type": "string",
      "description": "FASTQ samplesheet for Sarek (only when run_sarek=true).",
      "help_text": "CSV for upstream Sarek with patient/sample identifiers and FASTQ paths.",
      "fa_icon": "fas fa-file-csv",
      "format": "file-path",
      "mimetype": "text/csv",
      "pattern": "^\\S+\\.csv$"
    },

    "sarek_outdir": {
      "type": "string",
      "description": "Existing Sarek output directory to reuse (when run_sarek=false).",
      "help_text": "Should contain preprocessing/mapped/*/*.sorted.bam and variant_calling/*/*/*.vcf.gz.",
      "fa_icon": "fas fa-folder-open",
      "format": "directory-path"
    },

    "post_only_samplesheet": {
      "type": "string",
      "description": "Post-only samplesheet (when run_sarek=false).",
      "help_text": "CSV with columns: sample,vcf,bam[,bai]. Use when you have BAM/VCF ready and do not want to run Sarek.",
      "fa_icon": "fas fa-file-csv",
      "format": "file-path",
      "mimetype": "text/csv",
      "pattern": "^\\S+\\.csv$"
    }
  },

  "required": ["outdir", "run_sarek"],

  "allOf": [
    {
      "if": {
        "properties": { "run_sarek": { "const": true } },
        "required": ["run_sarek"]
      },
      "then": {
        "required": ["samplesheet"]
      }
    },
    {
      "if": {
        "properties": { "run_sarek": { "const": false } },
        "required": ["run_sarek"]
      },
      "then": {
        "oneOf": [
          { "required": ["sarek_outdir"] },
          { "required": ["post_only_samplesheet"] }
        ]
      }
    }
  ],

  "additionalProperties": true
}
